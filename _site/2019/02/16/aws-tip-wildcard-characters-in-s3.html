<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>AWS tip: Wildcard characters in S3 lifecycle policy prefixes | Your awesome title</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="AWS tip: Wildcard characters in S3 lifecycle policy prefixes" />
<meta name="author" content="Craig Watcham" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A quick word of warning regarding S3’s treatment of asterisks () in object lifecycle policies. In S3 asterisks are valid ‘special’ characters and can be used in object key names, this can lead to a lifecycle action not being applied as expected when the prefix contains an asterisk. Historically an asterisk is treated as a wildcard to pattern match ‘any’, so you would be able to conveniently match all files for a certain pattern: ‘rm *’ as an example, would delete all files. This is NOT how an asterisk behaves in S3 lifecycle prefixes. If you specify a prefix of ‘’ or ‘/’ it will only be applied to objects that start with an asterisk and not all objects. The ‘’ prefix rule would be applied to these objects: example-bucket//key example-bucket/yek But would not be applied to: example-bucket/object example-bucket/directory/key example-bucket/tcejbo* It is not an error to specify an asterisk and it will merely result in the policy not being applied so you may not even know this as an issue. Fortunately it is fairly easy to check for this configuration with the CLI, the following bash one liner will iterate through all buckets owned by the caller and check if the bucket has any policies with an asterisk in their name. It will print out the bucket name and policy if affected or a ‘.’ (to show progress) if not." />
<meta property="og:description" content="A quick word of warning regarding S3’s treatment of asterisks () in object lifecycle policies. In S3 asterisks are valid ‘special’ characters and can be used in object key names, this can lead to a lifecycle action not being applied as expected when the prefix contains an asterisk. Historically an asterisk is treated as a wildcard to pattern match ‘any’, so you would be able to conveniently match all files for a certain pattern: ‘rm *’ as an example, would delete all files. This is NOT how an asterisk behaves in S3 lifecycle prefixes. If you specify a prefix of ‘’ or ‘/’ it will only be applied to objects that start with an asterisk and not all objects. The ‘’ prefix rule would be applied to these objects: example-bucket//key example-bucket/yek But would not be applied to: example-bucket/object example-bucket/directory/key example-bucket/tcejbo* It is not an error to specify an asterisk and it will merely result in the policy not being applied so you may not even know this as an issue. Fortunately it is fairly easy to check for this configuration with the CLI, the following bash one liner will iterate through all buckets owned by the caller and check if the bucket has any policies with an asterisk in their name. It will print out the bucket name and policy if affected or a ‘.’ (to show progress) if not." />
<link rel="canonical" href="http://localhost:4000/2019/02/16/aws-tip-wildcard-characters-in-s3.html" />
<meta property="og:url" content="http://localhost:4000/2019/02/16/aws-tip-wildcard-characters-in-s3.html" />
<meta property="og:site_name" content="Your awesome title" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-02-16T15:21:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="AWS tip: Wildcard characters in S3 lifecycle policy prefixes" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Craig Watcham"},"dateModified":"2019-02-16T15:21:00+00:00","datePublished":"2019-02-16T15:21:00+00:00","description":"A quick word of warning regarding S3’s treatment of asterisks () in object lifecycle policies. In S3 asterisks are valid ‘special’ characters and can be used in object key names, this can lead to a lifecycle action not being applied as expected when the prefix contains an asterisk. Historically an asterisk is treated as a wildcard to pattern match ‘any’, so you would be able to conveniently match all files for a certain pattern: ‘rm *’ as an example, would delete all files. This is NOT how an asterisk behaves in S3 lifecycle prefixes. If you specify a prefix of ‘’ or ‘/’ it will only be applied to objects that start with an asterisk and not all objects. The ‘’ prefix rule would be applied to these objects: example-bucket//key example-bucket/yek But would not be applied to: example-bucket/object example-bucket/directory/key example-bucket/tcejbo* It is not an error to specify an asterisk and it will merely result in the policy not being applied so you may not even know this as an issue. Fortunately it is fairly easy to check for this configuration with the CLI, the following bash one liner will iterate through all buckets owned by the caller and check if the bucket has any policies with an asterisk in their name. It will print out the bucket name and policy if affected or a ‘.’ (to show progress) if not.","headline":"AWS tip: Wildcard characters in S3 lifecycle policy prefixes","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2019/02/16/aws-tip-wildcard-characters-in-s3.html"},"url":"http://localhost:4000/2019/02/16/aws-tip-wildcard-characters-in-s3.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css">
  <link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Your awesome title" />
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Your awesome title</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">AWS tip: Wildcard characters in S3 lifecycle policy prefixes</h1>
    <p class="post-meta"><time class="dt-published" datetime="2019-02-16T15:21:00+00:00" itemprop="datePublished">
        Feb 16, 2019
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Craig Watcham</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    A quick word of warning regarding S3's treatment of asterisks (*) in object&nbsp;<a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/object-lifecycle-mgmt.html">lifecycle policies</a>. In S3 asterisks are valid <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMetadata.html#object-keys">'special' characters</a>&nbsp;and can be used in object key names, this can lead to a lifecycle action not being applied as expected when the prefix contains an asterisk.<br />
<br />
Historically an asterisk is treated as a wildcard to pattern match 'any', so you would be able to conveniently match all files for a certain pattern: 'rm *' as an example, would delete all files. This is NOT how an asterisk behaves in S3 lifecycle prefixes. If you specify a prefix of '*' or '/*' it will only be applied to objects that start with an asterisk and not all objects. The '*' prefix rule would be applied to these objects:<br />
example-bucket/*/key<br />
example-bucket/*yek<br />
<br />
But would not be applied to:<br />
example-bucket/object<br />
example-bucket/directory/key<br />
example-bucket/tcejbo*<br />
<br />
It is not an error to specify an asterisk and it will merely result in the policy not being applied so you may not even know this as an issue. Fortunately it is fairly easy to check for this configuration with the CLI, the following bash one liner will iterate through all buckets owned by the caller and check if the bucket has any policies with an asterisk in their name. It will print out the bucket name and policy if affected or a '.' (to show progress) if not.<br />
<br />
<script src="https://gist.github.com/watchamcb/bc99754981bc68b5c398829ca51b72be.js"></script>

<div>
You can also check the S3 console, it should display 'Whole bucket' under the 'Applied To' column for any lifecycle rules you intended to have applied to the entire bucket.</div>

  </div><a class="u-url" href="/2019/02/16/aws-tip-wildcard-characters-in-s3.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="http://localhost:4000/feed.xml">
            <svg class="svg-icon orange">
              <path d="M12.8 16C12.8 8.978 7.022 3.2 0 3.2V0c8.777 0 16 7.223 16 16h-3.2zM2.194
                11.61c1.21 0 2.195.985 2.195 2.196 0 1.21-.99 2.194-2.2 2.194C.98 16 0 15.017 0
                13.806c0-1.21.983-2.195 2.194-2.195zM10.606
                16h-3.11c0-4.113-3.383-7.497-7.496-7.497v-3.11c5.818 0 10.606 4.79 10.606 10.607z"
              />
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">GitHub User</li>
          <li><a class="u-email" href="mailto:your-email@domain.com">your-email@domain.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
